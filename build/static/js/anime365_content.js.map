{"version":3,"file":"static/js/anime365_content.js","mappings":"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","sources":["chromeServices/anime365_content.ts"],"sourcesContent":["export {}\r\nlet timerId: string | number | NodeJS.Timeout | undefined;\r\nlet countCurrentTime: number = 0;\r\nlet countDurationTime: number = 0;\r\nlet styleElem: HTMLStyleElement | undefined;\r\nlet hrefChevronRight: string;\r\nchrome.runtime.onMessage.addListener(function (request) {\r\n    // Получаем сообщение от background что страница готова\r\n    if (request && request.type === 'page-rendered-anime365') {\r\n        //Очистим таймер если есть\r\n        clearInterval(timerId);\r\n        //Проверим наличие плеера\r\n        if (document.getElementById(\"videoFrame\")) {\r\n            const videoFrame = document.getElementById(\"videoFrame\")!;\r\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\r\n            const iFrame = (<HTMLIFrameElement>videoFrame).contentWindow;\r\n            //Пределим наличие кнопки на следующую серию\r\n            if (document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"i\").item(1)){\r\n                hrefChevronRight = document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"a\").item(1)?.href || \"/\";\r\n            }else if(document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"i\").item(0)?.textContent === \"chevron_right\"){\r\n                hrefChevronRight = document.getElementsByClassName(\"m-select-sibling-episode\").item(0)?.getElementsByTagName(\"a\").item(0)?.href || \"/\";\r\n            }else{\r\n                hrefChevronRight = \"/\";\r\n            }\r\n            //Запустим таймер\r\n            timerId = setTimeout(function tick() {\r\n                //Получим состояние видео\r\n                countCurrentTime = iFrame?.document.getElementsByTagName(\"video\").item(0)?.currentTime || 0;\r\n                countDurationTime = iFrame?.document.getElementsByTagName(\"video\").item(0)?.duration || 0;\r\n                //Если до конца тайтла осталось 15 секунд покажем блок\r\n                if (videoFrame && countDurationTime - 15 <= countCurrentTime && countDurationTime > 0 && countCurrentTime > 0 && hrefChevronRight !== \"/\") {\r\n                    //Вернём наличие нашего блока\r\n                    const mainBlock = iFrame?.document.getElementById(\"answer_is_forty_two\");\r\n                    //Если блока нет\r\n                    if (!mainBlock) {\r\n                        //Созданим элементы блока\r\n                        const div = document.createElement('div');\r\n                        const a = document.createElement('a');\r\n                        const span = document.createElement('span');\r\n                        div.id = \"answer_is_forty_two\";\r\n                        span.innerText = \"Далее\";\r\n                        a.title = \"Нажмите чтобы отменить\";\r\n                        a.onclick = function () {\r\n                            //При нажатии на блок очистим таймер и удалим блок\r\n                            clearInterval(timerId);\r\n                            iFrame?.document.getElementById(\"answer_is_forty_two\")?.remove();\r\n                            styleElem?.remove();\r\n                        }\r\n                        div.appendChild(a).appendChild(span);\r\n                        styleElem = iFrame?.document.head.appendChild(document.createElement(\"style\"));\r\n                        styleElem!.innerHTML = \"#answer_is_forty_two{background-color: #ff6d0033; position:absolute; bottom:10%; right:5%;}\" +\r\n                            \"#answer_is_forty_two a{border-radius: 2px; display: block; cursor: pointer; width: 200px; height: 40px; line-height: 40px; font-size: 18px; font-family: sans-serif; text-decoration: none; color: #fff;border: 1px solid #fff;letter-spacing: 2px;text-align: center;position: relative;transition: all .35s;}\" +\r\n                            \"#answer_is_forty_two a:after{border-radius: 2px; position: absolute; content: \\\"\\\"; top: 0; left: 0; width: var(--width, 0); height: 100%; background: #ff6d00; transition: all .35s;}\" +\r\n                            \"#answer_is_forty_two a:hover{color: #fff; background: #ff6d0088;}\" +\r\n                            \"#answer_is_forty_two a span{position: relative; z-index: 2;}\";\r\n                        //Добавим блок во фрейм\r\n                        const container = iFrame?.document.getElementsByClassName(\"vjs-control-bar\").item(0)!;\r\n                        const parent = container.parentNode!\r\n                        parent.insertBefore(div, container)\r\n                    } else {\r\n                        //Если дошли до конца то переходим по ссылке\r\n                        if (countCurrentTime === countDurationTime && hrefChevronRight !== \"/\") {\r\n                            //Проверить возможность сохранить в память состояние плеера, после перехода на следующую серию вернуть. fullscreen, play/pause\r\n                            document.location.href = hrefChevronRight;\r\n                        }\r\n                        //Визуализируем счётчик\r\n                        mainBlock.getElementsByTagName(\"a\").item(0)?.style.setProperty(\"--width\", ((countDurationTime - countCurrentTime - 15) * 100 * -1) / 15 + \"%\");\r\n                    }\r\n                } else {\r\n                    iFrame?.document.getElementById(\"answer_is_forty_two\")?.remove();\r\n                    styleElem?.remove();\r\n                }\r\n                timerId = setTimeout(tick, 500);\r\n            }, 500);\r\n\r\n        }\r\n    }\r\n});"],"names":["timerId","styleElem","hrefChevronRight","countCurrentTime","countDurationTime","chrome","runtime","onMessage","addListener","request","type","clearInterval","document","getElementById","videoFrame","iFrame","contentWindow","getElementsByClassName","item","getElementsByTagName","href","textContent","setTimeout","tick","currentTime","duration","mainBlock","location","style","setProperty","div","createElement","a","span","id","innerText","title","onclick","remove","appendChild","head","innerHTML","container","parentNode","insertBefore"],"sourceRoot":""}